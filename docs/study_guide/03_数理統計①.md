# AIに必要な数理・統計知識①

> **G検定 学習ガイド** | 分野：数理統計① | 70P | 2026-02-25

---

## データの中心を示す指標：平均値・中央値・最頻値

データ全体の特徴を把握する上で、そのデータがどのような値を中心に分布しているかを知ることは非常に重要です。ここでは、データの「中心」を表す代表的な3つの指標、**平均値**、**中央値**、**最頻値**について解説します。

### 平均値

**平均値**は、全てのデータの値を合計し、その合計をデータの総数で割ることで求められる値です。最も一般的に使われる「平均」であり、データの重心を示す指標と言えます。

**計算例:**
データが「42, 48, 56, 62, 82」の場合を考えます。
1.  全てのデータを足し合わせます: $42 + 48 + 56 + 62 + 82 = 290$
2.  データの数（5個）で割ります: $290 \div 5 = 58$
したがって、このデータの平均値は **58** です。

### 中央値

**中央値**（メディアン）は、データを小さい順に並べたときにちょうど中央に位置する値のことです。

*   **データ数が奇数の場合**: 真ん中の値が中央値になります。
    **例:** データが「42, 48, 56, 62, 82」の場合、小さい順に並べると「42, 48, **56**, 62, 82」となり、中央値は **56** です。
*   **データ数が偶数の場合**: 真ん中に近い2つの値の平均値が中央値になります。
    **例:** データが「42, 48, 56, 62, 82, 90」の場合、小さい順に並べると「42, 48, **56, 62**, 82, 90」となり、中央の2つの値は56と62です。これらの平均値 $(56 + 62) \div 2 = 59$ が中央値となります。

### 最頻値

**最頻値**（モード）は、データの中で最も頻繁に出現する値のことです。

**計算例:**
データが「1, 1, 1, 1, 1, 1, 4, 4, 5, 8, 10, 13, 15」の場合、最も多く出現しているのは「1」（6回）です。
したがって、このデータの最頻値は **1** です。
複数の値が同じ頻度で最も多く出現する場合、最頻値は複数存在することもあります。

### 外れ値の影響

**外れ値**とは、他のデータと比べて著しく小さい、または大きな値のことです。例えば、「42, 48, 56, 62, 82, 670」というデータがあった場合、「670」が外れ値にあたります。

これらの中心を示す指標は、外れ値の影響を受けやすいものと受けにくいものがあります。

*   **平均値**: 外れ値の影響を非常に受けやすいです。
    上記の例「42, 48, 56, 62, 82, 670」で平均値を計算すると、$ (42+48+56+62+82+670) \div 6 = 960 \div 6 = 160 $ となり、外れ値がない場合の平均値58と比べて大きく変動します。
*   **中央値・最頻値**: 外れ値の影響を受けにくいという特徴があります。
    上記の例で中央値を計算すると、「42, 48, **56, 62**, 82, 670」となり、中央値は $(56+62) \div 2 = 59$ と、外れ値がない場合とほとんど変わりません。最頻値も、外れ値が一つ増えただけでは通常変わりません。

> 📌 **G検定頻出ポイント**:
> *   **平均値、中央値、最頻値の定義と計算方法**は基本中の基本です。
> *   **外れ値がデータに与える影響**は特に重要です。**平均値は外れ値の影響を受けやすい**のに対し、**中央値や最頻値は受けにくい**という特徴を理解しておきましょう。どのような状況でどの指標を使うべきか、という判断が問われることがあります。

---

## 時系列データの傾向を捉える：移動平均

**移動平均**は、株価や気温、売上などの**時系列データ**（時間の経過とともに変化するデータ）の短期的な変動をならし、長期的な傾向やサイクルを把握するために使われる手法です。

### 移動平均の仕組み

移動平均では、一定の期間（例えば5日間、20日間など）のデータを区切り、その期間内の平均値を計算します。そして、時間が1単位進むごとに、最も古いデータを外し、新しいデータを加えて再び平均値を計算します。この「窓」を移動させながら平均を計算していくことから「移動平均」と呼ばれます。

**例:** 株式市場の株価を分析する際、今日の株価だけでなく、過去20日間の平均株価（20日移動平均）を参考にすることで、株価全体の動きやトレンドをより理解しやすくなります。
1.  1日目から20日目までの株価の平均を計算。
2.  2日目になったら、2日目から21日目までの株価の平均を計算。
3.  これを繰り返すことで、日々の細かい変動に惑わされずに、株価の大きな流れを捉えることができます。

### 移動平均の種類

一般的に使われるのは、単純に期間内のデータを足し合わせて数で割る**算術移動平均**ですが、他にも様々な移動平均があります。例えば、より新しいデータに重みをつけて計算する**加重移動平均**や、指数関数的に重みを減らしていく**指数移動平均**などがあり、分析の目的に応じて使い分けられます。

> 📌 **G検定頻出ポイント**:
> *   **移動平均の目的**は、時系列データの**平滑化**（ノイズ除去）と**トレンド把握**です。
> *   **一定期間のデータを移動させながら平均を計算する**という基本的な仕組みを理解しておきましょう。

---

## データの分布を可視化する：ヒストグラムと度数分布

大量のデータを収集しても、数字の羅列だけではそのデータが持つ全体的な特徴や傾向を理解することは困難です。そこで、データを整理し、視覚的に分かりやすく表現する**表**や**グラフ**が役立ちます。中でも、数値データの分布を把握するのに非常に有効なのが**ヒストグラム**です。

### 度数分布表の作成

ヒストグラムを作成する前段階として、データを整理するために**度数分布表**を作成します。

**例:** ある数学テストの点数データ（30人分）があるとします。
68, 45, 90, 98, 40, 73, 82, 55, 60, 44,
45, 83, 78, 66, 63, 65, 64, 35, 55, 50,
59, 55, 70, 67, 54, 73, 82, 68, 59, 58

このままでは、点数の分布がどうなっているか分かりにくいです。そこで、以下のステップで度数分布表を作成します。

1.  **階級の設定**: データを一定の範囲でグループ分けします。このグループの区間を**階級**と呼びます。階級の幅は、データの性質や目的に応じて適切に設定します。
    *   例: 「30点以上43点以下」「44点以上57点以下」のように設定します。
2.  **度数の集計**: 各階級に属するデータの個数を数えます。この個数を**度数**と呼びます。

| 階級（点数）     | 度数（人数） |
| :--------------- | :----------- |
| 30点以上43点以下 | 2            |
| 44点以上57点以下 | 8            |
| 58点以上71点以下 | 12           |
| 72点以上85点以下 | 6            |
| 86点以上99点以下 | 2            |
| **合計**         | **30**       |

このように、データを複数の階級に分け、各階級に属するデータの数（度数）を表形式でまとめたものを**度数分布表**と呼びます。

### ヒストグラムの作成

**ヒストグラム**は、度数分布表を棒グラフのような形で表現したものです。

1.  **横軸に階級**を、**縦軸に度数**を取ります。
2.  各階級の度数に応じた高さの長方形を、隣接させて描きます。

これにより、データの分布の形（どこにデータが集中しているか、ばらつきはどうかなど）を視覚的に捉えることができます。

> 📌 **G検定頻出ポイント**:
> *   **ヒストグラムの目的**は、**数値データの分布の形状を可視化する**ことです。
> *   **階級**、**度数**、**度数分布表**、**ヒストグラム**の各用語の定義と、それらの関係性を理解しておくことが重要です。
> *   ヒストグラムは、データの偏りや集中度、外れ値の有無などを一目で把握するのに役立ちます。

---

## データのばらつきを示す指標：分散・標準偏差

データの中心を示す平均値だけでは、データ全体の様子を十分に把握することはできません。例えば、平均点が同じ2つのクラスがあったとしても、片方のクラスは全員が平均点付近に集中しているのに対し、もう片方のクラスは高得点と低得点に二極化している、ということもありえます。このように、データの「ばらつき」の度合いを示す指標が**分散**と**標準偏差**です。

### 偏差

まず、**偏差**という概念を理解しましょう。
**偏差**とは、個々のデータが平均値からどれくらい離れているかを示す値です。
$$ \text{偏差} = \text{個々のデータ} - \text{平均値} $$

**例:** あるテストの平均点が50点だったとします。
*   データAさんが40点の場合: 偏差は $40 - 50 = -10$
*   データBさんが60点の場合: 偏差は $60 - 50 = 10$

### 分散

**分散**は、各データの偏差を2乗した値の平均です。偏差をそのまま平均すると正と負の偏差が打ち消し合って0になってしまうため、2乗することで負の値をなくし、ばらつきの大きさを正しく評価できるようにします。
$$ \text{分散} = \frac{\sum (\text{個々のデータ} - \text{平均値})^2}{\text{データの数}} $$

**計算例:** 5人のテストの点数データを使って分散を計算してみましょう。

| 氏名 | 点数 | 偏差（点数 - 平均） | 偏差の2乗 |
| :--- | :--- | :------------------ | :-------- |
| Aさん | 40   | $40 - 50 = -10$     | $(-10)^2 = 100$ |
| Bさん | 60   | $60 - 50 = 10$      | $10^2 = 100$ |
| Cさん | 80   | $80 - 50 = 30$      | $30^2 = 900$ |
| Dさん | 30   | $30 - 50 = -20$     | $(-20)^2 = 400$ |
| Eさん | 40   | $40 - 50 = -10$     | $(-10)^2 = 100$ |
| **平均** | **50** | **合計: 0**         | **合計: 1600** |

1.  まず、点数の平均値を計算します: $(40+60+80+30+40) \div 5 = 250 \div 5 = 50$
2.  各データの偏差を計算し、さらにその偏差を2乗します。
3.  偏差の2乗の合計を計算します: $100 + 100 + 900 + 400 + 100 = 1600$
4.  偏差の2乗の合計をデータの数で割ります: $1600 \div 5 = 320$
したがって、このデータの分散は **320** です。

### 標準偏差

**標準偏差**は、分散の平方根（ルート）を取った値です。分散は偏差を2乗しているため単位が元のデータと異なりますが、標準偏差は元のデータと同じ単位に戻すことで、ばらつきの度合いをより直感的に理解しやすくします。
$$ \text{標準偏差} = \sqrt{\text{分散}} $$

上記の例の分散が320なので、標準偏差は $\sqrt{320} \approx 17.89$ となります。

> 📌 **G検定頻出ポイント**:
> *   **分散と標準偏差はデータのばらつき（散らばり具合）を示す指標**です。
> *   **偏差**の定義、**分散**が偏差の2乗の平均であること、**標準偏差**が分散の平方根であること、それぞれの**計算過程**を理解しておきましょう。
> *   標準偏差は、元のデータと同じ単位でばらつきを表すため、解釈しやすいという利点があります。

---

## データの典型的な分布：正規分布と標準偏差

世の中の様々な現象やデータは、特定のパターンで分布していることが多く、その中でも特に重要なのが**正規分布**です。

### 正規分布とは

**正規分布**は、平均値を中心として左右対称な釣鐘型（ベルカーブ）の形をした分布です。自然界の多くの現象（身長、体重、学力テストの点数、製品のサイズ誤差など）が正規分布に従うことが知られています。

正規分布は、その形状が**平均値 ($\mu$)** と**標準偏差 ($\sigma$)** の2つのパラメータによって完全に決まるという特徴があります。

### 標準偏差とデータ分布の割合

正規分布に従うデータでは、平均値と標準偏差を使って、データがどの範囲にどれくらいの割合で含まれるかを予測することができます。これは「**68-95-99.7ルール**」として知られています。

*   **平均値 ($\mu$) から $\pm 1$ 標準偏差 ($\sigma$) の範囲**:
    $\mu - \sigma$ から $\mu + \sigma$ の間には、データの**約68%**が含まれます。
*   **平均値 ($\mu$) から $\pm 2$ 標準偏差 ($\sigma$) の範囲**:
    $\mu - 2\sigma$ から $\mu + 2\sigma$ の間には、データの**約95%**が含まれます。
*   **平均値 ($\mu$) から $\pm 3$ 標準偏差 ($\sigma$) の範囲**:
    $\mu - 3\sigma$ から $\mu + 3\sigma$ の間には、データの**約99.7%**が含まれます。

**例:** あるテストの平均点が50点、標準偏差が17.89点だったとします。
*   $\mu \pm 1\sigma$ の範囲は $50 \pm 17.89$ なので、$32.11$点から$67.89$点の間に、受験者の約68%が存在すると考えられます。
*   $\mu \pm 2\sigma$ の範囲は $50 \pm (2 \times 17.89) = 50 \pm 35.78$ なので、$14.22$点から$85.78$点の間に、受験者の約95%が存在すると考えられます。

この性質は、品質管理や異常検知など、様々な分野で活用されています。

> 📌 **G検定頻出ポイント**:
> *   **正規分布の定義**（左右対称の釣鐘型）と、**平均値と標準偏差で形状が決まる**ことを理解しましょう。
> *   **標準偏差の範囲とデータが含まれる割合（68-95-99.7ルール）**は非常に重要で、G検定でも頻繁に問われます。具体的な数値例でこのルールを適用できるようにしておきましょう。

---

## 2つのデータの関係性：相関関係と相関係数

データ分析では、1つのデータの特性だけでなく、複数のデータが互いにどのような関係を持っているかを調べることがよくあります。ここでは、2つのデータ間の関連性を示す**相関関係**と、その強さを数値で表す**相関係数**について解説します。

### 相関関係の種類

**相関関係**とは、2つのデータの間に存在する関連性のことです。主に以下の3種類に分けられます。

1.  **正の相関**: 一方のデータの値が増加すると、もう一方のデータの値も増加する傾向がある関係です。
    *   **例:** 身長が高くなると体重も重くなる傾向がある（「身長と体重」）。
2.  **負の相関**: 一方のデータの値が増加すると、もう一方のデータの値は減少する傾向がある関係です。
    *   **例:** 気温が上がるとヒーターの売上は減少する傾向がある（「気温とヒーターの売上」）。
3.  **無相関**: 2つのデータの間に、正の相関も負の相関も見られない関係です。
    *   **例:** 個人の学力と靴のサイズには、通常関連性がない。

さらに、相関関係の強さによって「**強い相関**」と「**弱い相関**」に分けられます。データ間の関連性がはっきりしているほど「強い相関」、関連性がぼんやりしているほど「弱い相関」と表現されます。

### 相関係数

**相関係数**は、2つのデータの相関関係の強さと方向（正の相関か負の相関か）を数値で表したものです。

*   **相関係数の範囲**: 相関係数は**-1から1**までの値をとります。
*   **値の意味**:
    *   **1に近いほど**: 強い**正の相関**があることを示します。
    *   **-1に近いほど**: 強い**負の相関**があることを示します。
    *   **0に近いほど**: 相関関係が**弱い**（または**無相関**）であることを示します。

| 相関係数の値 | 相関の強さと方向 | 具体例 |
| :----------- | :--------------- | :----- |
| 1            | 完璧な正の相関   | （理論上） |
| 0.7～1       | 強い正の相関     | 身長と体重 |
| 0.3～0.7     | 中程度の正の相関 | |
| 0～0.3       | 弱い正の相関     | |
| 0            | 無相関           | 学力と靴のサイズ |
| -0.3～0      | 弱い負の相関     | |
| -0.7～-0.3   | 中程度の負の相関 | |
| -1～-0.7     | 強い負の相関     | 気温とヒーターの売上 |
| -1           | 完璧な負の相関   | （理論上） |

> 📌 **G検定頻出ポイント**:
> *   **相関関係の種類（正、負、無相関）**と、それぞれの**具体例**を理解しましょう。
> *   **相関係数の定義、範囲（-1から1）、そしてその値が示す意味**は非常に重要です。特に、値が1や-1に近いほど相関が強く、0に近いほど相関が弱いという点を押さえておきましょう。

---

## 相関係数の計算

相関係数を計算するためには、まず**共分散**という値を求める必要があります。

### 共分散

**共分散**は、2つのデータ（例えばXとY）のそれぞれの偏差の積を平均した値です。
$$ \text{共分散}(X, Y) = \frac{\sum (X_i - \bar{X})(Y_i - \bar{Y})}{\text{データの数}} $$
ここで、$X_i$と$Y_i$は個々のデータ、$\bar{X}$と$\bar{Y}$はそれぞれのデータの平均値を表します。

共分散は、2つのデータが同じ方向に動く傾向があるか（正の値）、逆方向に動く傾向があるか（負の値）を示しますが、その値の大きさ自体は単位に依存するため、相関の強さを直接比較するには不向きです。

### 相関係数の計算式

共分散をそれぞれのデータの標準偏差で割ることで、単位の影響を取り除き、-1から1の範囲に正規化された**相関係数**が得られます。
$$ \text{相関係数}(r) = \frac{\text{共分散}(X, Y)}{\text{標準偏差}(X) \times \text{標準偏差}(Y)} $$

**計算例:** 5人の身長(x)と体重(y)のデータを使って相関係数を計算してみましょう。

まず、それぞれの平均値を計算します。
*   身長の平均($\bar{x}$): $(172+162+180+178+168) \div 5 = 860 \div 5 = 172$ cm
*   体重の平均($\bar{y}$): $(62+58+82+58+60) \div 5 = 320 \div 5 = 64$ kg

次に、共分散を計算します。

| 身長(x) | 体重(y) | 偏差(x - $\bar{x}$) | 偏差(y - $\bar{y}$) | 偏差積 $(x - \bar{x})(y - \bar{y})$ |
| :------ | :------ | :------------------ | :------------------ | :---------------------------------- |
| 172     | 62      | $172 - 172 = 0$     | $62 - 64 = -2$      | $0 \times (-2) = 0$                 |
| 162     | 58      | $162 - 172 = -10$   | $58 - 64 = -6$      | $(-10) \times (-6) = 60$            |
| 180     | 82      | $180 - 172 = 8$     | $82 - 64 = 18$      | $8 \times 18 = 144$                 |
| 178     | 58      | $178 - 172 = 6$     | $58 - 64 = -6$      | $6 \times (-6) = -36$               |
| 168     | 60      | $168 - 172 = -4$    | $60 - 64 = -4$      | $(-4) \times (-4) = 16$             |
| **平均** | **172** | **64**              |                     | **合計: 184**                       |

共分散は、偏差積の合計をデータの数で割ったものです: $184 \div 5 = 36.8$

次に、それぞれの標準偏差を計算します。

**身長(x)の分散と標準偏差:**

| 身長(x) | 偏差(x - $\bar{x}$) | 偏差の2乗 |
| :------ | :------------------ | :-------- |
| 172     | 0                   | 0         |
| 162     | -10                 | 100       |
| 180     | 8                   | 64        |
| 178     | 6                   | 36        |
| 168     | -4                  | 16        |
| **平均** | **172**             | **合計: 216** |

身長の分散: $216 \div 5 = 43.2$
身長の標準偏差: $\sqrt{43.2} \approx 6.57$

**体重(y)の分散と標準偏差:**

| 体重(y) | 偏差(y - $\bar{y}$) | 偏差の2乗 |
| :------ | :------------------ | :-------- |
| 62      | -2                  | 4         |
| 58      | -6                  | 36        |
| 82      | 18                  | 324       |
| 58      | -6                  | 36        |
| 60      | -4                  | 16        |
| **平均** | **64

