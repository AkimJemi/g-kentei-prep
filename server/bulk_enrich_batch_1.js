import pkg from 'pg';
const { Pool } = pkg;

const connectionString = 'postgresql://g_kentei_prep_app_db_user:0vZFHekJvsuMexPcBCKx5Ix4Noy7WZJO@dpg-d63nv6cr85hc73bckig0-a.oregon-postgres.render.com/g_kentei_prep_app_db';
const pool = new Pool({
  connectionString,
  ssl: { rejectUnauthorized: false }
});

const enrichment = {
    1: ["ジョン・マッカーシーらによって開催されました。", "ENIACは1946年に完成した世界初の汎用電子計算機です。", "アラン・チューリングは1950年にテストを提案しましたが、この会議の主催者ではありません。", "スタンフォード大学は後の拠点ですが、会議の場所ではありません。"],
    2: ["人間のような精神的な状態（理解や意識）を持つAIを指します。", "特定のタスクをこなすだけのAIで、意識は持ちません。", "人間と同等の能力を持つこと指しますが、サールの分類では強い/弱いを使います。", "特定の領域（チェスなど）に限定されたAIです。"],
    3: ["人間のようにあらゆる課題をこなせるAIです。", "現在のAIのほとんど（画像認識、翻訳など）はこれに分類されます。", "意識や心を持つとされるAIの概念です。", "人間の介入なしに行動するAIを指しますが、範囲とは別の分類です。"],
    4: ["関係のない事柄を無視することの難しさに関する問題です。", "記号（シンボル）とその対象（意味）が結びついていない状態を指します。", "プログラムが有限時間で停止するか判定できない計算理論の問題です。", "倫理学上の思考実験です。"],
    5: ["データの次元が増えると空間が疎になり、学習が難しくなる現象です。", "世界中で起こりうる全ての事象を考慮しようとすると、計算量が爆発する問題です。", "シンボル崩壊という用語は一般的ではありません。", "計算量の急増を指しますが、ロボットの文脈ではフレーム問題が適切です。"],
    6: ["ハンス・モラベックが指摘した、高度な推論より子供の運動能力の方が実装が難しいという逆説です。", "機械が人間と区別がつかないかを判定するテストです。", "意味を理解せずとも記号操作で対話が可能かという思考実験です。", "地球外文明の存在に関する矛盾を指します。"],
    7: ["AIの名付け親でありLISPの開発者です。", "1950年の論文で「模倣ゲーム」を提案しました。", "AIの父の一人ですが、模倣ゲームの提案者ではありません。", "Logic Theoristを開発した論理学者です。"],
    8: ["初期のコンピュータの名前です。", "チューリングの部屋という用語はありません。", "ジョン・サールが「強いAI」への反論として提唱しました。", "マッカーシーの部屋という用語はありません。"],
    9: ["ニューウェルと共にLogic Theoristを開発しました。", "シンギュラリティの提唱者として知られています。", "Google Brain創設者の一人で、Courseraの共同創業者です。", "ディープラーニングの権威で、GANや注意機構に貢献しました。"],
    10: ["現実の複雑な問題ではなく、ルールが明確な迷路やパズルしか解けなかったことを指します。", "ショート・プロブレムという用語は一般的ではありません。", "シンプル・ケースは一般的な表現ですが、専門用語ではありません。", "ダミー・パズルという用語はありません。"],
    11: ["ENIACが公開された年です。", "論文「Computing Machinery and Intelligence」が掲載された年です。", "ダートマス会議が開催された年です。", "第1次AIブームの全盛期です。"],
    12: ["ダートマス会議の提案書でAIを定義しました。", "ディープラーニングのゴッドファーザーの一人です。", "OpenAIのCEOです。", "OpenAI共同創設者ですが、定義の考案者ではありません。"],
    13: ["知能には身体が不可欠であるとする考え方です。", "記号システムが一般的知能動作の十分条件を持つという仮説です。", "神経回路網を模倣するアプローチです。", "脳の働きを量子力学で説明しようとする仮説です。"],
    14: ["1956年のダートマス会議で公開された世界初のAIプログラムです。", "Logic Theoristの後継として開発された汎用問題解決プログラムです。", "1966年に開発された対話システムです。", "1970年代のエキスパートシステムです。"],
    15: ["心の働きは機能（入出力）で決まるとする立場です。", "知的な行動を示せば、内部の意識は問わないとする立場です。", "心や意識の概念そのものを否定する立場です。", "自分だけが存在するとする哲学的な立場です。"],
    16: ["知能は環境との相互作用（身体）から生まれるという考え方です。", "身体を介さない知能を想定する考え方です。", "心と体を別のものとして考えるデカルト的哲学です。", "すべての存在は物質であるとする考え方です。"],
    17: ["人間の完全な模倣ではありません（人間はミスをするため）。", "思考の正確性より、結果の合理性が重視されます。", "成果（報酬）を最大化するエージェントの理想像です。", "性能の一部ですが、合理性の定義そのものではありません。"],
    18: ["ALICEは後の時代のボットです。", "SIRIはAppleの音声アシスタントです。", "パターンマッチングでセラピストを模した対話プログラムです。", "積み木の世界を扱うプログラムです。"],
    19: ["自然言語の命令を理解し、積み木を操作したプログラムです。", "チェス専用のAIです。", "囲碁のAIです。", "クイズ回答システムです。"],
    20: ["ニューロンの結合強度によって学習するというアプローチです。", "数学的・論理的な形式を重視する考え方です。", "構成要素の関係性を重視する考え方です。", "記号操作に基づくAIのアプローチです。"],
    21: ["第3次ブームの中心技術です。", "第2次ブームの核となった、専門家の知識を模したシステムです。", "第3次ブームを支える要素です。", "手法の一つですが、ブームそのものの名称ではありません。"],
    22: ["データ分析コンペのプラットフォームです。", "2012年にAlexNetが優勝し、DLブームの火付け役となったコンペです。", "ロボット競技会です。", "DARPAは主催組織名であり、コンペ名ではありません。"],
    23: ["宇宙の始まりです。", "AIが人類の知性を超える技術的特異点です。", "ITによる変革のことです。", "仮想空間のことです。"],
    24: ["1997年にチェスで勝利したAIです。", "2011年にクイズ番組で人類に勝利したAIです。", "スパコンのプロジェクト名です。", "映画に登場する架空のAIです。"],
    25: ["否定的な表現で、一般的ではありません。", "特定の能力は高いが社会的常識が欠如している状態の例えです。", "SF作品のタイトルです。", "判断根拠が見えない状態を指します。"],
    26: ["人材目標としては少なすぎます。", "リテラシーから応用まで含めた目標値です。", "過大な目標です。", "全学生レベルの数字です。"],
    27: ["誰でも使えるデータのことです。", "量、多様性、速度を兼ね備えた巨大なデータ群です。", "モノのインターネットです。", "分散型台帳技術です。"],
    28: ["秋とは言いません。", "期待が裏切られ研究が停滞した時期を指します。", "氷河期とも言いますが、一般的表現は冬です。", "意味は通じますが、専門用語は冬です。"],
    29: ["将棋や電王戦の地です。", "別の対局地です。", "イ・セドル戦が行われた歴史的な対局地です。", "Googleの拠点ですが、対局地ではありません。"],
    30: ["Transformerを提案し、現代AIの基盤となった論文です。", "ResNetの論文です。", "ResNetに関連する用語です。", "AlexNetに関連する用語です。"],
    41: ["特定のカテゴリ（ラベル）を当てるタスクです。", "連続する数値を当てるタスクです。", "データの類似度でグループ化する手法です。", "データの情報を圧縮する手法です。"],
    42: ["カテゴリを分けるのは分類です。", "気温や価格など、連続した値を予測するタスクです。", "グループ化する手法です。", "情報を圧縮する手法です。"],
    43: ["重みが小さすぎる状態です。", "訓練データに過剰に適応し、未知データで外れる現象です。", "精度の低さ全般を指しますが、専門用語は過学習です。", "偏りのことです。"],
    44: ["単純に分けるだけの方法です。", "データを分割し、訓練とテストを入れ替えて評価する手法です。", "重複を許して抽出する手法です。", "無作為に選ぶことです。"],
    45: ["多数の決定木を統合するアンサンブル手法です。", "確率で分類する線形モデルです。", "近傍データで決める手法です。", "境界を最大化する手法です。"],
    46: ["クラスターに分ける手法です。", "近いk個のデータの多数決で決める手法です。", "データ構造の一つです。", "PCAの概念です。"],
    47: ["重みが大きくならないよう罰則を課す手法です。", "非線型性を導入することです。", "データを一定範囲に収めることです。", "平均0分散1にすることです。"],
    48: ["試行錯誤で報酬を最大化する学習です。", "正解ラベルから学ぶ学習です。", "ラベルなしで構造を学ぶ学習です。", "自分自身で学ぶ手法の総称案です。"],
    49: ["マージン最大化により境界を決める手法です。", "次元削減です。", "射影による判別です。", "分岐による予測です。"],
    50: ["データをグループ化します。", "分散を最大化して特徴を抽出（次元削減）する手法です。", "数値を予測します。", "精度を高めるアンサンブル手法です。"],
    51: ["全体の正答率です。", "正の実データのうち、正しく正と予測できた割合です。", "正と予測したうち、実際に正だった割合です。", "両者の調和平均です。"],
    52: ["全体の正答率です。", "見逃しのなさを表します。", "予測の正しさ（偽陽性の少なさ）を表します。", "負の実データを正しく負と予測できる割合です。"]
};

async function bulkEnrich() {
    console.log('[Bulk Enrich] Updating optionExplanations for first batch...');
    try {
        let updatedCount = 0;
        for (const [id, exps] of Object.entries(enrichment)) {
            const res = await pool.query(
                `UPDATE g_kentei_questions SET optionExplanations = $1 WHERE id = $2`,
                [JSON.stringify(exps), id]
            );
            if (res.rowCount > 0) {
                updatedCount++;
            }
        }
        console.log(`[Bulk Enrich] Successfully updated ${updatedCount} questions.`);
    } catch (err) {
        console.error('[Bulk Enrich] Error:', err.message);
    } finally {
        await pool.end();
    }
}

bulkEnrich();
